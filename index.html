<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>BÃ¬nh chá»n cáº·p Ä‘Ã´i</title>
<style>
body{background:#0d0d0d;color:#fff;font-family:Arial;max-width:900px;margin:auto;padding:20px}
h1,h2{text-align:center}
input,button{width:100%;padding:10px;margin:5px 0;border-radius:6px;border:none}
button{background:#ff69b4;font-weight:bold;cursor:pointer}
button:disabled{background:#555}
.box{background:#1c1c1c;padding:12px;border-radius:8px;margin:12px 0}
.couple{background:#262626;padding:8px;border-radius:6px;margin:6px 0}
.rank1{color:gold;font-weight:bold}
.rank2{color:silver;font-weight:bold}
.rank3{color:#cd7f32;font-weight:bold}
.badge{color:#00ff99;font-weight:bold}
a{color:cyan;font-weight:bold;text-decoration:none}
</style>
</head>
<body>

<div id="lock">
  <h2>Nháº­p code Ä‘á»ƒ vÃ o web</h2>
  <input id="codeInput">
  <button onclick="unlock()">VÃ o</button>
</div>

<div id="main" style="display:none">

<h1>ğŸ’– BÃ¬nh chá»n cáº·p Ä‘Ã´i ğŸ’–</h1>
<p style="text-align:center">
<a href="https://www.youtube.com/@anhmontongtai" target="_blank">
ğŸ‘‰ Qua kÃªnh YouTube anhmon tá»•ng tÃ i ğŸ‘ˆ
</a>
</p>

<div class="box">
<h2>ğŸ‘¤ Há»“ sÆ¡ cá»§a báº¡n</h2>
<p id="profile"></p>
</div>

<div class="box">
<h2>ğŸ§® Mini game giáº£i toÃ¡n</h2>
<p id="question"></p>
<input id="answer" placeholder="Nháº­p Ä‘Ã¡p Ã¡n">
<button onclick="checkAnswer()">Tráº£ lá»i</button>
<p id="gameInfo"></p>
</div>

<div class="box">
<h2>ğŸ† Top ngÆ°á»i nhiá»u Ä‘iá»ƒm</h2>
<div id="topPlayers"></div>
</div>

<div class="box">
<h2>â• Äá» xuáº¥t cáº·p Ä‘Ã´i</h2>
<input id="coupleInput" placeholder="TÃªn cáº·p Ä‘Ã´i">
<button onclick="addCouple()">ThÃªm cáº·p Ä‘Ã´i</button>
<p id="limitInfo"></p>
</div>

<div class="box">
<h2>ğŸ† Top cáº·p Ä‘Ã´i</h2>
<div id="topCouples"></div>
</div>

<div class="box">
<h2>ğŸ“‹ Danh sÃ¡ch cáº·p Ä‘Ã´i</h2>
<div id="list"></div>
</div>

</div>

<script>
const ACCESS_CODE="anhmontongtai";
const today=new Date().toDateString();

let user=JSON.parse(localStorage.getItem("user")||"null");
if(!user||user.date!==today){
  user={points:user?user.points:0,gameToday:0,date:today,votes:{},posts:0};
}

let couples=JSON.parse(localStorage.getItem("couples")||"[]");
let players=JSON.parse(localStorage.getItem("players")||"[]");

function unlock(){
  if(codeInput.value===ACCESS_CODE){
    lock.style.display="none";
    main.style.display="block";
    nextQuestion();
    render();
  } else alert("Sai code!");
}

function getTitle(){
  if(user.points>=1000) return "CÃ¡nh tay pháº£i Ä‘áº¯c lá»±c";
  if(user.points>=100) return "Sá»‘ng lÃ¢u trÄƒm tuá»•i";
  if(user.points>=50) return "NgÆ°á»i thÃ´ng minh kÃ¬ cá»±u ğŸŒ±";
  return "NgÆ°á»i má»›i";
}

function postLimit(){
  if(user.points>=1000) return 10;
  if(user.points>=100) return 5;
  return 2;
}

let a,b,op,correct;
function nextQuestion(){
  a=Math.floor(Math.random()*10)+1;
  b=Math.floor(Math.random()*10)+1;
  op=["+","-","Ã—"][Math.floor(Math.random()*3)];
  correct=op==="+"?a+b:op==="-"?a-b:a*b;
  question.innerText=`${a} ${op} ${b} = ?`;
}

function checkAnswer(){
  if(user.gameToday>=100){
    gameInfo.innerText="Báº¡n Ä‘Ã£ Ä‘áº¡t giá»›i háº¡n 100 Ä‘iá»ƒm mini game hÃ´m nay!";
    return;
  }

  if(parseInt(answer.value)===correct){
    let gain=1;
    if(user.points>=1000) gain=2; // x2 CHá»ˆ khi >=1000
    if(user.gameToday+gain>100) gain=100-user.gameToday;

    user.points+=gain;
    user.gameToday+=gain;
  }

  answer.value="";
  saveUser();
  nextQuestion();
  render();
}

function addCouple(){
  if(user.posts>=postLimit()){
    alert("HÃ´m nay báº¡n Ä‘Ã£ háº¿t lÆ°á»£t Ä‘Äƒng cáº·p!");
    return;
  }
  const name=coupleInput.value.trim();
  if(!name) return;
  couples.push({name,votes:0});
  user.posts++;
  coupleInput.value="";
  saveAll();
  render();
}

function vote(i){
  if(user.votes[i]) return;
  couples[i].votes++;
  user.votes[i]=true;
  saveAll();
  render();
}

function render(){
  profile.innerText=`Äiá»ƒm: ${user.points} | Danh hiá»‡u: ${getTitle()}`;
  limitInfo.innerText=`ÄÃ£ Ä‘Äƒng ${user.posts}/${postLimit()} cáº·p hÃ´m nay`;
  gameInfo.innerText=`Äiá»ƒm mini game hÃ´m nay: ${user.gameToday}/100`;

  topPlayers.innerHTML="";
  players=[...players.filter(p=>p.id!==today),{id:today,points:user.points}];
  players.sort((a,b)=>b.points-a.points).slice(0,5).forEach(p=>{
    topPlayers.innerHTML+=`<div class="couple">â¤ï¸ ${p.points} Ä‘iá»ƒm</div>`;
  });

  topCouples.innerHTML="";
  couples.filter(c=>c.votes>0).sort((a,b)=>b.votes-a.votes).slice(0,3)
  .forEach((c,i)=>{
    topCouples.innerHTML+=`<div class="couple rank${i+1}">
    ${["ğŸ¥‡ SiÃªu há»£p Ä‘Ã´i","ğŸ¥ˆ Ráº¥t há»£p Ä‘Ã´i","ğŸ¥‰ KhÃ¡ há»£p Ä‘Ã´i"][i]}<br>
    ${c.name} â€“ â¤ï¸ ${c.votes}</div>`;
  });

  list.innerHTML="";
  couples.forEach((c,i)=>{
    list.innerHTML+=`<div class="couple">
    <b>${c.name}</b> â¤ï¸ ${c.votes}<br>
    <button ${user.votes[i]?"disabled":""} onclick="vote(${i})">
    ${user.votes[i]?"ÄÃ£ vote":"Vote"}</button></div>`;
  });
}

function saveUser(){
  localStorage.setItem("user",JSON.stringify(user));
  saveAll();
}
function saveAll(){
  localStorage.setItem("couples",JSON.stringify(couples));
  localStorage.setItem("players",JSON.stringify(players));
}
</script>

</body>
</html>
