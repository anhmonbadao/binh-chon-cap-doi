<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>BÃ¬nh chá»n cáº·p Ä‘Ã´i Táº¿t ğŸ§§</title>

<style>
body{
  margin:0;
  background:#b30000;
  color:white;
  font-family:Arial;
  text-align:center;
}
h1,h2{color:gold}
.box{
  background:#fff;
  color:#000;
  width:90%;
  max-width:420px;
  margin:15px auto;
  padding:15px;
  border-radius:12px;
}
button{
  padding:8px 14px;
  margin:5px;
  cursor:pointer;
}
input{
  padding:6px;
  width:80%;
}
a{color:#00bfff}
.hidden{display:none}
.rank{font-weight:bold}
#lixiBig{
  font-size:80px;
  cursor:pointer;
}
.shake{
  animation:shake 0.3s infinite;
}
@keyframes shake{
  0%{transform:rotate(0deg)}
  25%{transform:rotate(2deg)}
  50%{transform:rotate(0deg)}
  75%{transform:rotate(-2deg)}
}
</style>
</head>

<body>

<!-- NHáº C Táº¾T -->
<iframe width="0" height="0"
src="https://www.youtube.com/embed/0N46LMV7UDU?autoplay=1&mute=1&loop=1">
</iframe>

<h1>ğŸ§§ BÃ¬nh chá»n cáº·p Ä‘Ã´i Táº¿t ğŸŒ¸ğŸŒ¼</h1>

<div class="box" id="loginBox">
  <h3>Nháº­p tÃªn</h3>
  <input id="username"><br><br>

  <h3>Nháº­p code</h3>
  <input id="code"><br>
  <small>code: anhmontongtai</small><br><br>

  <button onclick="enter()">VÃ o web</button>
</div>

<div id="main" class="hidden">

<!-- COIN -->
<div class="box">
  ğŸ§§ LÃ¬ xÃ¬ coin: <span id="coin">0</span>
</div>

<!-- Äá»€ XUáº¤T Cáº¶P ÄÃ”I -->
<div class="box">
  <h2>Äá» xuáº¥t cáº·p Ä‘Ã´i (tá»‘i Ä‘a 2/ngÃ y)</h2>
  <input id="pairInput" placeholder="TÃªn A â¤ TÃªn B">
  <button onclick="addPair()">Gá»­i</button>
</div>

<!-- DANH SÃCH VOTE -->
<div class="box">
  <h2>Vote cáº·p Ä‘Ã´i</h2>
  <div id="pairList"></div>
</div>

<!-- TOP -->
<div class="box">
  <h2>ğŸ† Top há»£p Ä‘Ã´i</h2>
  <div id="topPair"></div>
</div>

<div class="box">
  <h2>ğŸ§§ Top lÃ¬ xÃ¬ coin</h2>
  <div id="topCoin"></div>
</div>

<!-- MINI GAME -->
<div class="box">
  <h2>Mini game toÃ¡n</h2>
  <p id="mathQ"></p>
  <input id="mathA">
  <button onclick="checkMath()">Tráº£ lá»i</button>
  <p id="mathMsg"></p>
</div>

<!-- Äá»”I LÃŒ XÃŒ -->
<div class="box">
  <h2>ğŸ Bao lÃ¬ xÃ¬ nhá» (20 coin)</h2>
  <button onclick="openSmall()">Má»Ÿ</button>
  <p id="smallResult"></p>
</div>

<a href="#big">má»Ÿ lÃ¬ xÃ¬ tiá»n Ä‘áº§y tayğŸ§§</a>

<!-- LÃŒ XÃŒ VÃ€NG -->
<div class="box" id="big">
  <h2>ğŸ§§ LÃ¬ xÃ¬ vÃ ng khá»•ng lá»“</h2>
  <p id="timer"></p>
  <div id="lixiBig" onclick="openBig()">ğŸ§§</div>
</div>

<div class="box">
  <h2>Ä‚n trá»n lÃ¬ xÃ¬</h2>
  <div id="winnerList"></div>
</div>

</div>

<script>
let user="",coin=0;
let pairs=JSON.parse(localStorage.getItem("pairs")||"[]");
let votes=JSON.parse(localStorage.getItem("votes")||"{}");
let users=JSON.parse(localStorage.getItem("users")||"{}");
let today=new Date().toDateString();
let addCount=0;
let gameCount=0;

function enter(){
  if(code.value!=="anhmontongtai")return alert("Sai code");
  user=username.value.trim();
  if(!user)return alert("Nháº­p tÃªn");
  if(!users[user])users[user]={coin:0};
  coin=users[user].coin;
  loginBox.classList.add("hidden");
  main.classList.remove("hidden");
  update();
  newMath();
  startTimer();
}

function update(){
  coinSpan=coin;
  document.getElementById("coin").innerText=coin;
  showPairs();
  showTop();
  showTopCoin();
}

function addPair(){
  if(addCount>=2)return alert("Háº¿t lÆ°á»£t hÃ´m nay");
  let p=pairInput.value.trim();
  if(!p)return;
  pairs.push(p);
  votes[p]=0;
  addCount++;
  localStorage.setItem("pairs",JSON.stringify(pairs));
  localStorage.setItem("votes",JSON.stringify(votes));
  showPairs();
}

function showPairs(){
  pairList.innerHTML="";
  pairs.forEach(p=>{
    let d=document.createElement("div");
    d.innerHTML=p+" ("+(votes[p]||0)+") <button onclick='vote(\""+p+"\")'>Vote</button>";
    pairList.appendChild(d);
  });
}

function vote(p){
  votes[p]++;
  coin++;
  users[user].coin=coin;
  localStorage.setItem("votes",JSON.stringify(votes));
  localStorage.setItem("users",JSON.stringify(users));
  update();
}

function showTop(){
  let arr=Object.entries(votes).sort((a,b)=>b[1]-a[1]).slice(0,3);
  topPair.innerHTML=arr.map((x,i)=>`${i+1}. ${x[0]} (${x[1]})`).join("<br>");
}

function showTopCoin(){
  let arr=Object.entries(users).sort((a,b)=>b[1].coin-a[1].coin).slice(0,5);
  topCoin.innerHTML=arr.map(x=>`${x[0]}: ${x[1].coin}`).join("<br>");
}

function newMath(){
  a=Math.floor(Math.random()*10);
  b=Math.floor(Math.random()*10);
  mathQ.innerText=`${a}+${b}=?`;
  ans=a+b;
}

function checkMath(){
  if(gameCount>=100)return;
  if(+mathA.value===ans){
    coin++;
    gameCount++;
    users[user].coin=coin;
    localStorage.setItem("users",JSON.stringify(users));
    mathMsg.innerText="ÄÃºng!";
  }else mathMsg.innerText="Sai!";
  newMath();update();
}

function openSmall(){
  if(coin<20)return;
  coin-=20;
  let r=Math.random()*100;
  let msg="Xá»‹t";
  if(r<0.5)msg="10k";
  else if(r<10)msg="5k";
  else if(r<20)msg="1k";
  smallResult.innerText=msg;
  users[user].coin=coin;
  localStorage.setItem("users",JSON.stringify(users));
  update();
}

let end=Date.now()+3600000;
function startTimer(){
  setInterval(()=>{
    let t=end-Date.now();
    if(t<=0){timer.innerText="Má»!";lixiBig.classList.add("shake")}
    else timer.innerText=Math.floor(t/1000)+"s";
  },1000);
}

function openBig(){
  if(Date.now()<end)return;
  let r=Math.random()*100;
  let money="Xá»‹t";
  if(r<1)money="50k";
  else if(r<10)money="10k";
  else if(r<20)money="5k";
  else if(r<40)money="1k";
  winnerList.innerHTML+=`${user}: ${money}<br>`;
}
</script>

</body>
</html>
