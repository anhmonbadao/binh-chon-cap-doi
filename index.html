<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>BÃ¬nh chá»n cáº·p Ä‘Ã´i</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }
    h1, h2 {
      text-align: center;
    }
    .hidden {
      display: none;
    }
    .box {
      background: #fff;
      padding: 15px;
      margin: 15px auto;
      max-width: 520px;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,.1);
    }
    button {
      padding: 6px 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button.vote {
      background: #ff6fae;
      color: #fff;
    }
    button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
    input {
      width: 100%;
      padding: 8px;
      margin: 6px 0;
    }
  </style>
</head>
<body>

<h1>ğŸ’– BÃ¬nh chá»n cáº·p Ä‘Ã´i ğŸ’–</h1>

<!-- MÃ€N NHáº¬P CODE -->
<div id="login" class="box">
  <h3>ğŸ” Nháº­p code Ä‘á»ƒ vÃ o</h3>
  <input id="codeInput" placeholder="Nháº­p code..." />
  <button onclick="checkCode()">VÃ o</button>
  <p id="error" style="color:red"></p>
</div>

<!-- TRANG CHÃNH -->
<div id="main" class="hidden">

  <!-- TOP Xáº¾P Háº NG -->
  <div class="box">
    <h2>ğŸ† Top cáº·p Ä‘Ã´i</h2>
    <div id="top"></div>
  </div>

  <!-- ADMIN THÃŠM Cáº¶P ÄÃ”I -->
  <div class="box">
    <h3>ğŸ‘‘ ThÃªm cáº·p Ä‘Ã´i (admin)</h3>
    <input id="coupleInput" placeholder="VÃ­ dá»¥: Minh Ã— Vy" />
    <button onclick="addCouple()">ThÃªm</button>
  </div>

  <!-- DANH SÃCH Cáº¶P ÄÃ”I -->
  <div id="couples"></div>
</div>

<script>
  /* ===== Cáº¤U HÃŒNH ===== */

  // CODE Báº®T BUá»˜C NHáº¬P Äá»‚ VÃ€O WEB
  const ACCESS_CODE = "anhmontongtai";

  // CÃC Cáº¶P ÄÃ”I ADMIN Táº O Sáº´N
  const ADMIN_COUPLES = [
    "Minh Ã— Vy",
    "An Ã— Linh",
    "KhÃ´i Ã— Ngá»c"
  ];

  /* ==================== */

  let voted = JSON.parse(localStorage.getItem("voted") || "{}");
  let couples = JSON.parse(localStorage.getItem("couples") || "null");

  // Láº¦N Äáº¦U VÃ€O WEB
  if (!couples) {
    couples = ADMIN_COUPLES.map(name => ({
      name: name,
      votes: 0,
      admin: true
    }));
    save();
  }

  function checkCode() {
    const v = document.getElementById("codeInput").value;
    if (v === ACCESS_CODE) {
      document.getElementById("login").classList.add("hidden");
      document.getElementById("main").classList.remove("hidden");
      render();
    } else {
      document.getElementById("error").innerText = "Sai code";
    }
  }

  function save() {
    localStorage.setItem("couples", JSON.stringify(couples));
    localStorage.setItem("voted", JSON.stringify(voted));
  }

  function addCouple() {
    const name = document.getElementById("coupleInput").value.trim();
    if (!name) return;
    couples.push({
      name: name,
      votes: 0,
      admin: false
    });
    document.getElementById("coupleInput").value = "";
    save();
    render();
  }

  function vote(i) {
    // CHá»ˆ ÄÆ¯á»¢C VOTE 1 Láº¦N / 1 Cáº¶P
    if (voted[i]) return;
    couples[i].votes++;
    voted[i] = true;
    save();
    render();
  }

  function render() {
    /* TOP Xáº¾P Háº NG */
    const topDiv = document.getElementById("top");
    topDiv.innerHTML = "";
    [...couples]
      .sort((a, b) => b.votes - a.votes)
      .slice(0, 5)
      .forEach((c, idx) => {
        topDiv.innerHTML +=
          `${idx + 1}. ${c.name} â€“ â¤ï¸ ${c.votes}<br>`;
      });

    /* DANH SÃCH Cáº¶P ÄÃ”I */
    const div = document.getElementById("couples");
    div.innerHTML = "";
    couples.forEach((c, i) => {
      const box = document.createElement("div");
      box.className = "box";
      box.innerHTML = `
        <b>${c.name}</b><br><br>
        â¤ï¸ ${c.votes} lÆ°á»£t bÃ¬nh chá»n<br><br>
        <button class="vote"
          onclick="vote(${i})"
          ${voted[i] ? "disabled" : ""}>
          ${voted[i] ? "ÄÃ£ bÃ¬nh chá»n" : "BÃ¬nh chá»n"}
        </button>
      `;
      div.appendChild(box);
    });
  }
</script>

</body>
</html>
