<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BÃ¬nh chá»n cáº·p Ä‘Ã´i - Anhmon Tá»•ng TÃ i</title>
<style>
body{
  background:#0e0e0e;
  color:#fff;
  font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  max-width:900px;
  margin:auto;
  padding:20px;
  line-height: 1.6;
}
h1,h2{text-align:center; color: #ff69b4;}
input,button{
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:8px;
  border:none;
  box-sizing: border-box;
}
input{
  background: #262626;
  color: #fff;
  border: 1px solid #444;
}
button{
  background:#ff69b4;
  color: white;
  font-weight:bold;
  cursor:pointer;
  transition: 0.3s;
}
button:hover{ background: #ff1493; }
button:disabled{background:#555; cursor: not-allowed;}

.box{
  background:#1c1c1c;
  padding:15px;
  border-radius:10px;
  margin:15px 0;
  border: 1px solid #333;
}
.couple{
  background:#262626;
  padding:12px;
  border-radius:8px;
  margin:8px 0;
  border-left: 4px solid #ff69b4;
}
.rank1{color:gold; font-size: 1.2em; border-left-color: gold;}
.rank2{color:silver; border-left-color: silver;}
.rank3{color:#cd7f32; border-left-color: #cd7f32;}

a{color:cyan; font-weight:bold; text-decoration:none;}
a:hover{text-decoration: underline;}

.video{
  position:relative;
  padding-bottom:56.25%;
  height:0;
  overflow:hidden;
  border-radius:12px;
  margin-bottom:20px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.5);
}
.video iframe{
  position:absolute;
  top:0;left:0;
  width:100%;height:100%
}
.hint{color:#888; text-align:center; font-size:14px; margin-top: 10px;}
#adminBadge {
    background: gold;
    color: black;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: bold;
    display: none;
}
</style>
</head>
<body>

<div id="lock">
  <div class="video">
    <iframe 
      src="https://www.youtube.com/embed/nAP-Jk7fgHM?autoplay=1&mute=1"
      frameborder="0" 
      allow="autoplay; encrypted-media" 
      allowfullscreen>
    </iframe>
  </div>

  <h2>Nháº­p mÃ£ xÃ¡c thá»±c</h2>
  <p class="hint">MÃ£ thÃ nh viÃªn: <b>anhmontongtai</b></p>

  <input type="text" id="codeInput" placeholder="Nháº­p mÃ£ vÃ o Ä‘Ã¢y...">
  <button onclick="unlock()">XÃ¡c nháº­n vÃ o Web</button>
  <p id="lockError" style="color: #ff4d4d; text-align: center;"></p>
</div>

<div id="main" style="display:none">

<h1>ğŸ’– BÃ¬nh chá»n cáº·p Ä‘Ã´i ğŸ’– <span id="adminBadge">ADMIN</span></h1>

<p style="text-align:center">
<a href="https://www.youtube.com/@anhmontongtai" target="_blank">
ğŸ¬ GhÃ© thÄƒm kÃªnh YouTube Anhmon Tá»•ng TÃ i
</a>
</p>

<div class="box">
<h2>ğŸ‘¤ ThÃ´ng tin cÃ¡ nhÃ¢n</h2>
<p id="profile"></p>
</div>

<div class="box">
<h2>ğŸ§® Thá»­ thÃ¡ch toÃ¡n há»c (Kiáº¿m Ä‘iá»ƒm)</h2>
<p id="question" style="font-size: 20px; font-weight: bold; text-align: center;"></p>
<input type="number" id="answer" placeholder="ÄÃ¡p Ã¡n lÃ  gÃ¬?">
<button onclick="checkAnswer()">Gá»­i Ä‘Ã¡p Ã¡n</button>
<p id="gameInfo" style="font-size: 0.9em; color: #bbb;"></p>
</div>

<div class="box">
<h2>ğŸ”¥ Báº£ng xáº¿p háº¡ng ngÆ°á»i chÆ¡i</h2>
<div id="topPlayers"></div>
</div>

<div class="box">
<h2>â• Äá» xuáº¥t cáº·p Ä‘Ã´i má»›i</h2>
<input type="text" id="coupleInput" placeholder="TÃªn cáº·p Ä‘Ã´i (VD: Anh A - Chá»‹ B)">
<button onclick="addCouple()">ÄÄƒng Ä‘á» xuáº¥t</button>
<p id="limitInfo" style="font-size: 0.8em;"></p>
</div>

<div class="box">
<h2>ğŸ† Top 3 cáº·p Ä‘Ã´i Ä‘Æ°á»£c yÃªu thÃ­ch nháº¥t</h2>
<div id="topCouples"></div>
</div>

<div class="box">
<h2>ğŸ“‹ Danh sÃ¡ch táº¥t cáº£ cáº·p Ä‘Ã´i</h2>
<div id="list"></div>
</div>

</div>

<script>
// Cáº¤U HÃŒNH MÃƒ
const USER_CODE = "anhmontongtai";
const ADMIN_CODE = "anhmonbadao"; // MÃƒ ADMIN Má»šI Cá»¦A Báº N
const today = new Date().toDateString();

// KHá»I Táº O Dá»® LIá»†U
let adminUsed = localStorage.getItem("adminUsed") === "true";
let user = JSON.parse(localStorage.getItem("user") || "null");
let couples = JSON.parse(localStorage.getItem("couples") || "[]");
let players = JSON.parse(localStorage.getItem("players") || "[]");

// Náº¿u chÆ°a cÃ³ user hoáº·c qua ngÃ y má»›i, reset cÃ¡c giá»›i háº¡n ngÃ y
if(!user || user.date !== today){
  user = {
    points: user ? user.points : 0,
    gameToday: 0,
    date: today,
    votes: {},
    posts: 0,
    isAdmin: user ? user.isAdmin : false
  };
}

// HÃ€M Má» KHÃ“A
function unlock(){
  const input = document.getElementById("codeInput").value.trim();
  const errorMsg = document.getElementById("lockError");

  if(input === ADMIN_CODE){
    // KIá»‚M TRA: Náº¿u mÃ£ Ä‘Ã£ dÃ¹ng vÃ  báº¡n khÃ´ng pháº£i lÃ  ngÆ°á»i Ä‘ang giá»¯ quyá»n admin Ä‘Ã³
    if(adminUsed && !user.isAdmin){
      errorMsg.innerText = "âŒ MÃ£ Admin nÃ y Ä‘Ã£ Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi ngÆ°á»i khÃ¡c!";
      return;
    }
    // Náº¿u chÆ°a ai dÃ¹ng, kÃ­ch hoáº¡t quyá»n admin cho báº¡n
    user.isAdmin = true;
    localStorage.setItem("adminUsed", "true");
    alert("KÃ­ch hoáº¡t quyá»n ADMIN thÃ nh cÃ´ng!");
  } 
  else if(input === USER_CODE){
    // VÃ o vá»›i tÆ° cÃ¡ch thÃ nh viÃªn
  }
  else {
    errorMsg.innerText = "âŒ MÃ£ khÃ´ng chÃ­nh xÃ¡c!";
    return;
  }

  saveAll();
  enterWeb();
}

function enterWeb(){
  document.getElementById("lock").style.display = "none";
  document.getElementById("main").style.display = "block";
  if(user.isAdmin) document.getElementById("adminBadge").style.display = "inline";
  nextQuestion();
  render();
}

// CÃC HÃ€M LOGIC GAME
function getTitle(){
  if(user.isAdmin) return "ADMIN Tá»”NG TÃ€I ğŸ‘‘";
  if(user.points >= 1000) return "CÃ¡nh tay pháº£i Ä‘áº¯c lá»±c";
  if(user.points >= 100) return "Sá»‘ng lÃ¢u trÄƒm tuá»•i";
  if(user.points >= 50) return "NgÆ°á»i thÃ´ng minh kÃ¬ cá»±u ğŸŒ±";
  return "ThÃ nh viÃªn má»›i";
}

function postLimit(){
  if(user.isAdmin) return 999; // Admin khÃ´ng giá»›i háº¡n
  if(user.points >= 1000) return 10;
  if(user.points >= 100) return 5;
  return 2;
}

let a, b, op, correct;
function nextQuestion(){
  a = Math.floor(Math.random() * 10) + 1;
  b = Math.floor(Math.random() * 10) + 1;
  const ops = ["+", "-", "Ã—"];
  op = ops[Math.floor(Math.random() * ops.length)];
  correct = op === "+" ? a + b : op === "-" ? a - b : a * b;
  document.getElementById("question").innerText = `${a} ${op} ${b} = ?`;
}

function checkAnswer(){
  const ansInput = document.getElementById("answer");
  if(user.gameToday >= 100 && !user.isAdmin){
    alert("Báº¡n Ä‘Ã£ háº¿t lÆ°á»£t kiáº¿m Ä‘iá»ƒm hÃ´m nay!");
    return;
  }
  
  if(parseInt(ansInput.value) === correct){
    let gain = user.points >= 1000 ? 2 : 1;
    user.points += gain;
    user.gameToday += gain;
    alert("ChÃ­nh xÃ¡c! + " + gain + " Ä‘iá»ƒm");
  } else {
    alert("Sai rá»“i, cá»‘ gáº¯ng nhÃ©!");
  }
  
  ansInput.value = "";
  saveAll();
  nextQuestion();
  render();
}

function addCouple(){
  if(user.posts >= postLimit()){
    alert("Báº¡n Ä‘Ã£ háº¿t lÆ°á»£t Ä‘Äƒng cáº·p Ä‘Ã´i hÃ´m nay!");
    return;
  }
  const name = document.getElementById("coupleInput").value.trim();
  if(!name) return;
  
  couples.push({ name, votes: 0, id: Date.now() });
  user.posts++;
  document.getElementById("coupleInput").value = "";
  saveAll();
  render();
}

function vote(id){
  // TÃ¬m cáº·p Ä‘Ã´i theo ID
  const index = couples.findIndex(c => c.id === id);
  if(user.votes[id] && !user.isAdmin) return;
  
  couples[index].votes++;
  user.votes[id] = true;
  saveAll();
  render();
}

function deleteCouple(id){
  if(!user.isAdmin) return;
  if(confirm("Admin muá»‘n xÃ³a cáº·p Ä‘Ã´i nÃ y?")){
    couples = couples.filter(c => c.id !== id);
    saveAll();
    render();
  }
}

function render(){
  document.getElementById("profile").innerText = `Äiá»ƒm: ${user.points} | Danh hiá»‡u: ${getTitle()}`;
  document.getElementById("limitInfo").innerText = `HÃ´m nay Ä‘Ã£ Ä‘Äƒng: ${user.posts}/${user.isAdmin ? 'âˆ' : postLimit()}`;
  document.getElementById("gameInfo").innerText = `Tiáº¿n trÃ¬nh Ä‘iá»ƒm hÃ´m nay: ${user.gameToday}/100`;

  // Top ngÆ°á»i chÆ¡i (mÃ´ phá»ng báº£ng xáº¿p háº¡ng Ä‘á»‹a phÆ°Æ¡ng)
  const topP = document.getElementById("topPlayers");
  topP.innerHTML = "";
  players = [...players.filter(p => p.id !== "You"), {id: "You", points: user.points}];
  players.sort((a,b) => b.points - a.points).slice(0, 5)
    .forEach(p => topP.innerHTML += `<div class="couple">ğŸ‘¤ ${p.id === "You" ? "Báº¡n" : "NgÆ°á»i chÆ¡i áº©n danh"}: ${p.points} Ä‘iá»ƒm</div>`);

  // Top cáº·p Ä‘Ã´i
  const topC = document.getElementById("topCouples");
  topC.innerHTML = "";
  [...couples].sort((a,b) => b.votes - a.votes).slice(0, 3)
    .forEach((c, i) => {
      if(c.votes > 0) {
        topC.innerHTML += `
        <div class="couple rank${i+1}">
          ${["ğŸ¥‡ Háº¡ng nháº¥t","ğŸ¥ˆ Háº¡ng nhÃ¬","ğŸ¥‰ Háº¡ng ba"][i]}<br>
          <b>${c.name}</b> â€“ â¤ï¸ ${c.votes} lÆ°á»£t bÃ¬nh chá»n
        </div>`;
      }
    });

  // Danh sÃ¡ch Ä‘áº§y Ä‘á»§
  const listDiv = document.getElementById("list");
  listDiv.innerHTML = "";
  couples.forEach((c) => {
    listDiv.innerHTML += `
    <div class="couple">
      <b>${c.name}</b> â¤ï¸ ${c.votes}
      <div style="display:flex; gap: 5px; margin-top:5px;">
        <button ${user.votes[c.id] && !user.isAdmin ? "disabled" : ""} onclick="vote(${c.id})" style="flex:3">
          ${user.votes[c.id] ? "ÄÃ£ bÃ¬nh chá»n" : "BÃ¬nh chá»n"}
        </button>
        ${user.isAdmin ? `<button onclick="deleteCouple(${c.id})" style="flex:1; background:red;">XÃ³a</button>` : ""}
      </div>
    </div>`;
  });
}

function saveAll(){
  localStorage.setItem("user", JSON.stringify(user));
  localStorage.setItem("couples", JSON.stringify(couples));
  localStorage.setItem("players", JSON.stringify(players));
}
</script>

</body>
</html>
